# EMG 实时可视化系统

基于 WAVELETECH EMG 传感器的 3 通道实时监测系统，支持波形显示、RMS计算和运动传感器数据可视化。

## 功能特性

- 📊 **实时EMG波形显示**
  - 3通道EMG信号同步显示
  - 10秒滚动时间窗口
  - 动态Y轴缩放

- 📈 **RMS实时计算**
  - 200ms窗口RMS计算
  - 柱状图实时显示
  - 数值标签更新

- 🎯 **运动传感器监测**
  - 3轴陀螺仪数据
  - 3轴加速度计数据
  - 5秒滚动窗口

## 技术规格

- **采样率**: 100Hz（实际测试值）
- **EMG通道**: 3个通道
- **RMS窗口**: 200ms
- **显示窗口**: 10秒（EMG）、5秒（运动数据）
- **数据格式**: 16位ADC

## 安装依赖

```bash
pip install numpy matplotlib pyserial
```

## 使用方法

### 1. 连接设备
确保 WAVELETECH EMG 传感器已连接到USB串口。

### 2. 运行程序

#### 模拟数据版本（无需设备）：
```bash
python emg_realtime_visualizer.py
```

#### 实际设备版本：
```bash
python emg_realtime_3ch.py
```

### 3. 操作说明
- 程序启动后自动连接设备
- 实时显示EMG波形和RMS值
- 运动传感器数据在底部图表显示
- 按 Ctrl+C 退出程序

## 界面布局

```
┌─────────────────────────────────────┬─────────────────┐
│                                     │                 │
│          EMG 信号波形               │   RMS 指示器    │
│        (3通道同步显示)              │   (200ms窗口)   │
│                                     │                 │
├─────────────────────────────────────┤                 │
│                                     │                 │
│          运动传感器数据             │                 │
│      (陀螺仪+加速度计)              │                 │
│                                     │                 │
└─────────────────────────────────────┴─────────────────┘
```

## 数据格式

### EMG数据
- 范围：-32768 到 32767（16位ADC）
- 单位：原始ADC值

### 陀螺仪数据
- 范围：约 -40 到 +40 rad/s
- 分辨率：0.0012 rad/s per LSB

### 加速度计数据
- 范围：约 -20 到 +20 m/s²
- 分辨率：0.0005978 m/s² per LSB

## 测试工具

### 串口数据测试
```bash
python quick_test.py
```
测试设备连接和数据解析，显示原始数据格式。

### 串口监控
```bash
python serial_test.py
```
提供多种串口监控选项，包括十六进制原始数据显示。

## 故障排除

### 常见问题

1. **设备连接失败**
   - 检查USB连接
   - 确认串口权限
   - 验证设备型号

2. **数据显示异常**
   - 检查数据包格式
   - 调整解析器参数
   - 验证采样率设置

3. **性能问题**
   - 减少显示窗口大小
   - 降低更新频率
   - 检查系统资源

### 调试模式

启用详细日志输出：
```python
# 在代码中添加调试信息
print(f"接收数据: {new_data}")
```

## 自定义配置

### 修改采样率
```python
visualizer = EMGVisualizer(
    sample_rate=100,        # 调整采样率
    window_duration=10.0,   # 调整显示窗口
    rms_window=0.2          # 调整RMS窗口
)
```

### 修改串口参数
```python
data_source = EMGDataSource(
    port="/dev/ttyUSB0",    # 修改串口路径
    baudrate=115200         # 修改波特率
)
```

## 扩展功能

### 添加新通道
1. 修改数据解析器
2. 更新可视化布局
3. 调整颜色配置

### 数据记录
添加CSV文件输出功能：
```python
import csv
# 在数据接收时记录到文件
```

### 网络传输
实现数据网络广播：
```python
import socket
# 通过UDP发送数据
```

## 技术支持

如遇问题请检查：
1. Python版本（推荐3.7+）
2. 依赖包版本
3. 设备驱动程序
4. 系统串口权限

## 许可证

本项目基于MIT许可证开源。